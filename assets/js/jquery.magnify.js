/*!
 * jQuery Magnify Plugin v2.3.2 by T. H. Doan (https://thdoan.github.io/magnify/)
 * Based on http://thecodeplayer.com/walkthrough/magnifying-glass-for-images-using-jquery-and-css3
 *
 * jQuery Magnify by T. H. Doan is licensed under the MIT License.
 * Read a copy of the license in the LICENSE file or at https://choosealicense.com/licenses/mit/
 */
!function(t){t.fn.magnify=function(i){i=t.extend({src:"",speed:100,timeout:-1,touchBottomOffset:0,finalWidth:null,finalHeight:null,magnifiedWidth:null,magnifiedHeight:null,limitBounds:!1,mobileCloseEvent:"touchstart",afterLoad:function(){}},i);var e=this,n=t("html"),a=function(e){var a=t(e),o=a.closest("a"),r={};for(var f in i)r[f]=a.attr("data-magnify-"+f.toLowerCase());var l=r.src||i.src||o.attr("href")||"";if(l){var d,u,c,h,g,m,p,v,y,b,w=0,N=0,P=function(){var t=d.offset();return b={top:a.offset().top-t.top+parseInt(a.css("border-top-width"))+parseInt(a.css("padding-top")),left:a.offset().left-t.left+parseInt(a.css("border-left-width"))+parseInt(a.css("padding-left"))},t.top+=b.top,t.left+=b.left,t},X=function(){u.is(":visible")&&u.fadeOut(i.speed,function(){n.removeClass("magnifying").trigger("magnifyend")})},Y=function(t){if(!h)return void s();if(t?(t.preventDefault(),nPosX=t.pageX||t.originalEvent.touches[0].pageX,nPosY=t.pageY||t.originalEvent.touches[0].pageY,a.data("lastPos",{x:nPosX,y:nPosY})):(nPosX=a.data("lastPos").x,nPosY=a.data("lastPos").y),nX=nPosX-y.left,nY=nPosY-y.top-i.touchBottomOffset,u.is(":animated")||(nX>w&&nX<c-w&&nY>N&&nY<h-N?u.is(":hidden")&&(n.addClass("magnifying").trigger("magnifystart"),u.fadeIn(i.speed)):X()),u.is(":visible")){var e="";if(g&&m){var o=-Math.round(nX/c*g-p/2),r=-Math.round(nY/h*m-v/2);if(i.limitBounds){var f=-Math.round((c-w)/c*g-p/2),l=-Math.round((h-N)/h*m-v/2);o>0?o=0:o<f&&(o=f),r>0?r=0:r<l&&(r=l)}e=o+"px "+r+"px"}u.css({top:Math.round(nY-v/2)+b.top+"px",left:Math.round(nX-p/2)+b.left+"px","background-position":e})}};isNaN(+r.speed)||(i.speed=+r.speed),isNaN(+r.timeout)||(i.timeout=+r.timeout),isNaN(+r.finalWidth)||(i.finalWidth=+r.finalWidth),isNaN(+r.finalHeight)||(i.finalHeight=+r.finalHeight),isNaN(+r.magnifiedWidth)||(i.magnifiedWidth=+r.magnifiedWidth),isNaN(+r.magnifiedHeight)||(i.magnifiedHeight=+r.magnifiedHeight),"true"===r.limitBounds&&(i.limitBounds=!0),"function"==typeof window[r.afterLoad]&&(i.afterLoad=window[r.afterLoad]),/\b(Android|BlackBerry|IEMobile|iPad|iPhone|Mobile|Opera Mini)\b/.test(navigator.userAgent)?isNaN(+r.touchBottomOffset)||(i.touchBottomOffset=+r.touchBottomOffset):i.touchBottomOffset=0,a.data("originalStyle",a.attr("style"));var B=new Image;t(B).on({load:function(){var e,n;a.css("display","block"),a.parent(".magnify").length||a.wrap('<div class="magnify"></div>'),d=a.parent(".magnify"),a.prev(".magnify-lens").length?d.children(".magnify-lens").css("background-image","url('"+l+"')"):a.before('<div class="magnify-lens loading" style="background:url(\''+l+"') 0 0 no-repeat\"></div>"),u=d.children(".magnify-lens"),u.removeClass("loading"),c=i.finalWidth||a.width(),h=i.finalHeight||a.height(),g=i.magnifiedWidth||B.width,m=i.magnifiedHeight||B.height,p=u.width(),v=u.height(),y=P(),i.limitBounds&&(w=p/2/(g/c),N=v/2/(m/h)),g===B.width&&m===B.height||u.css("background-size",g+"px "+m+"px"),a.data("zoomSize",{width:g,height:m}),d.data("mobileCloseEvent",r.mobileCloseEvent||i.mobileCloseEvent),B=null,i.afterLoad(),u.is(":visible")&&Y(),d.off().on({"mousemove touchmove":Y,mouseenter:function(){y=P()},mouseleave:X}),i.timeout>=0&&d.on("touchend",function(){setTimeout(X,i.timeout)}),t("body").not(d).on("touchstart",X);var s=a.attr("usemap");if(s){var f=t("map[name="+s.slice(1)+"]");a.after(f),d.click(function(i){if(i.clientX||i.clientY){u.hide();var a=document.elementFromPoint(i.clientX||i.originalEvent.touches[0].clientX,i.clientY||i.originalEvent.touches[0].clientY);"AREA"===a.nodeName?a.click():t("area",f).each(function(){var i=t(this).attr("coords").split(",");if(e>=i[0]&&e<=i[2]&&n>=i[1]&&n<=i[3])return this.click(),!1})}})}o.length&&(o.css("display","inline-block"),!o.attr("href")||r.src||i.src||o.click(function(t){t.preventDefault()}))},error:function(){B=null}}),B.src=l}},o=0,s=function(){clearTimeout(o),o=setTimeout(function(){e.destroy(),e.magnify(i)},100)};return this.destroy=function(){return this.each(function(){var i=t(this),e=i.prev("div.magnify-lens"),n=i.data("originalStyle");i.parent("div.magnify").length&&e.length&&(n?i.attr("style",n):i.removeAttr("style"),i.unwrap(),e.remove())}),t(window).off("resize",s),e},t(window).resize(s),this.each(function(){a(this)})}}(jQuery);